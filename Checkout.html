<!DOCTYPE html>
<html>
    <head>
        <title>IGgrowth | Buy Instagram Followers</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="icon" type="image/jpg" href="images/BannerMaker_28022023_2111111.png">
        <link rel="stylesheet" href="style.css">
    </head>
    <body>
        <header class="Header" style="height: 70px;">
            <a href="index.html">
            <img src="images/BannerMaker_27022023_205920.png" height="55px" style="position: relative; justify-content: center;">
            </a>
            <a href="index.html">
            <button id="back">&lt;Back</button>
            </a>
        </header>
        <div style="position: absolute; background-color: #F3F6FD; width: 100%; height: 100%;"></div>
        <div style="display: flex; justify-content: center;">
            <div id="checkout-box">
                <div style="position: absolute; display: flex; flex-direction: column; align-items: center;">
                    <h3 id="text-amount">100 Instagram Followers</h3>
                    <div id="dividing-line"></div>
                    <input type="text" id="usernameInput" placeholder="Instagram username">
                    <button id="submitBtn">Continue</button>
                    <span id="errorText"></span>
                    <div id="loadingText" style="font-weight: bold;"></div>
                    <div style="display: flex; justify-content: center;">
                    <a href="Buy Instagram Followers.html" style="position: absolute; top: 310px;">
                        <button id="select-different">Pick a different package</button>
                    </a>
                    </div>
                </div>
            </div>
        </div>
        <script src="index.js"></script>
        <script>
  document.addEventListener('DOMContentLoaded', function() {
  const textValue = localStorage.getItem('textValue');
  const textElement = document.getElementById('text-amount');
  textElement.textContent = textValue+' Instagram Followers';
});

        document.getElementById("submitBtn").addEventListener("click", function() {
    
function updateLoadingText() {
  const loadingText = document.getElementById("loadingText");
  let dots = submitBtn.textContent;

  if (dots === '...') {
    dots = ".";
  } else {
    dots += ".";
  }

  submitBtn.textContent = dots;
}   
  document.getElementById("errorText").textContent = "";
  const usernameInput = document.getElementById("usernameInput");

  const usernameValue = usernameInput.value.trim();

  if (usernameValue.length === 0) {
    usernameInput.style.borderColor = "red";
    document.getElementById("errorText").textContent = "Please enter a username";
    return;
  } else {
    usernameInput.style.borderColor = "";
  }
    // Start the animation
    document.getElementById("submitBtn").textContent = ".";
    const textAmount = document.getElementById('text-amount').textContent;
    const numberPattern = /\d+/;
    const intervalId = setInterval(updateLoadingText, 250);
    var username = document.getElementById("usernameInput").value;
    var plan = parseInt(textAmount.match(numberPattern)[0]);
    var data = { "username": username,
               	 "plan": plan};

    fetch("http://13.244.63.193", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify(data)
    })
    .then(response => response.json())
    .then(data => {
      // Handle the response data here
      console.log(data);

      // Check if 'error' field is present in the response
      if (data.Message === 'Please set your Instagram account to public') {
        document.getElementById("errorText").textContent = "Please set your Instagram account to public";
              setTimeout(() => {
  clearInterval(intervalId);
}, 0);
      submitBtn.textContent = "Continue";
      } else if (data.Message === 'Please enter a valid Instagram username') {
    document.getElementById("errorText").textContent = "Please enter a valid Instagram username.";
              setTimeout(() => {
  clearInterval(intervalId);
}, 0);
      submitBtn.textContent = "Continue";
      } else {
              setTimeout(() => {
  clearInterval(intervalId);
}, 0);
      submitBtn.textContent = "Continue";
      var newTab = window.open("https://socialpros.io/buy-instagram-followers", "_blank", "noopener");
      }
    })
    .catch(error => {
      console.error("Error:", error);
      document.getElementById("errorText").textContent = "Please try again.";
      setTimeout(() => {
  clearInterval(intervalId);
}, 0);
      submitBtn.textContent = "Continue";
    });
  });
</script>

        </script>
    </body>
</html>
